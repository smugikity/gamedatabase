{% load static %}
<link rel="stylesheet" href="{% static 'css/card.css' %}"/>
{% for game in data %}
    <div class="col-lg-4 col-md-6 pt-2">
        <div class="card d-flex flex-column align-items-center">
            <span class="wish-icon">
                {% if game.is_favorited %}
                    <i class="fa fa-heart" value="{{ game.id }}"></i>
                {% else %}
                    <i class="fa fa-heart-o" value="{{ game.id }}"></i>
                {% endif %}
            </span>
            <div class="card-img d-flex justify-content-center" onclick='viewGameItem({{ game.id }});'> <img class="rounded" src="/media/{{ game.image }}" alt="image"></div>
            <div class="card-content" onclick='viewGameItem({{ game.id }});'>
                <div class="text-danger"><strong>{{ game.title }}</strong></div>		
                <div class="text-danger">{{ game.avg_rating }}<small class="text-muted"> ({{ game.n_ratings }})</small></div>		
                <div class="tags-container">
                    {% for genre in game.genre_list|slice:"0:3" %}
                        <span>{{ genre.title }}</span>
                    {% endfor %}
                </div>
            </div>
            {% comment %} <div class="card-body pt-4">
                <div class="d-flex align-items-center price">
                <div class="del mr-2"><span class="text-dark">5500 uah</span></div>
                <div class="font-weight-bold">4500 uah</div>
                </div>
            </div> {% endcomment %}
        </div>
    </div>
{% endfor %}
 
<script type="text/javascript">
{% if is_authenticated %}
$('.wish-icon i').on("click", function() {
    id = $(this).attr('value')
    if ($(this).hasClass("fa-heart")) {
        try {
            $.ajax({
                url: '/p-list/wishlist/remove?game='+id,
                success:function(res) {
                    console.log(res);
                    
                }
            });
        }
        catch(err) {
            console.log(err);
            return;
        }
    } else {
        try {
            $.ajax({
                url: '/p-list/wishlist/add?game='+id,
                success:function(res) {
                    console.log(res);
                    
                }
            });
        }
        catch(err) {
            console.log(err);
            return;
        }
    }
    $(this).toggleClass('fa-heart fa-heart-o');
})
{% endif %}
function viewGameItem(id) {
    window.location.href = ('/view/game/'+id);
}
</script>